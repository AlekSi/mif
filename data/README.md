## Импорт данных

Загружаем данные о книгах издательства МИФ из публичных источников.

### Шаг 1. Импорт из Яндекс.Маркета

__Директория:__ `import`

__Команда:__ `go run import.go`

__Что делает:__ загружает каталог МИФ для Яндекс.Маркета и парсит информацию из него в файлы `import/categories.csv` и `import/books.csv`
с категориями и данными о продаваемых книгах. 

В директории `import` также есть файл `mif-catalog.xml`, он нужен 
только для примера того, в каком формате отдаются данные из каталога.


### Шаг 2. Поиск ссылок на сайте МИФ

__Директория:__ `link-list`

__Команда:__ `go run parse.go`

__Что делает:__ запрашивает каталог на сайте МИФа в поисках ссылок на книги. 
Сохраняет в файле `link-list/links.txt` список найденных ссылок.

В директории `link-list` также есть файл `links_white.txt`, он содержит список ссылок на первые книги из "Белой серии" МИФа.

### Шаг 3. Используем sitemap для поиска ссылок на книги

__Директория:__ `link-list`

__Команда:__ `go run sitemap.go`

__Что делает:__ запрашивает `sitemap/books.xml` на сайте МИФа в поисках ссылок на книги. 
Сохраняет в файле `link-list/links_sitemap.txt` список найденных ссылок.

В директории `link-list` также есть файл `links_white.txt`, он содержит список ссылок на первые книги из "Белой серии" МИФа.


### Шаг 4. Сохраняем категории

__Директория:__ `save`

__Команда:__ `env DB_HOST=localhost DB_PORT=5432 DB_USER=postgres DB_PASS=mysecretpassword DB=mifbooks go run categories.go`

__Что делает:__ берет из файла `import/categories.csv` категории и сохраняет их в БД.
Если категория с таким ID уже существует, она будет обновлена в базе данных. 
Параметры доступа к БД задаются через переменные окружения.

### Шаг 5. Сохраняем книги из маркета

__Директория:__ `save`

__Команда:__ `env DB_HOST=localhost DB_PORT=5432 DB_USER=postgres DB_PASS=mysecretpassword DB=mifbooks go run books.go`

__Что делает:__ берет из файла `import/books.csv` книги и сохраняет их в БД.
Если книга с таким URL уже существует, она будет обновлена в базе данных.
Параметры доступа к БД задаются через переменные окружения.

### Шаг 6. Сохраняем URL'ы, которые насобирали

__Директория:__ `save`

__Команда:__ `env DB_HOST=localhost DB_PORT=5432 DB_USER=postgres DB_PASS=mysecretpassword DB=mifbooks go run urls.go`

__Что делает:__ берет из файлов `link-list/links_white.txt`, `link-list/links_sitemap.txt`, `link-list/links.txt`
ссылки и сохраняет их в БД. Ссылка будет добавлена в таблицу `books`, но вставка произойдет только в том случае, 
если книги с такой ссылкой еще не существует.
Параметры доступа к БД задаются через переменные окружения.

### Шаг 7. Загружаем книги для собранных URL'ов

__Директория:__ `update`

__Команда:__ `env DB_HOST=localhost DB_PORT=5432 DB_USER=postgres DB_PASS=mysecretpassword DB=mifbooks go run books.go`

__Что делает:__ для всех книг из таблицы `books`, у которых не задан `title` (есть только URL книги), заходит
на страницу книги и собирает с этой страницы основную (ID, название, автор, категория) и дополнительную (ISBN)
информацию.

### Шаг 8. Загружаем информацию о форматах книг

__Директория:__ `update`

__Команда:__ `env DB_HOST=localhost DB_PORT=5432 DB_USER=postgres DB_PASS=mysecretpassword DB=mifbooks go run volumes.go`

__Что делает:__ на основе файла `link-list/links.txt` сохраняет информацию о том, в каких форматах (бумага, электронный, аудио) представлена книга.
